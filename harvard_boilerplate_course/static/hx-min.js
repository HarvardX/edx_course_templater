var HXGlobalJS=function(){"use strict";void 0===window.hxLocalOptions&&(window.hxLocalOptions={}),void 0===window.HXPUPTimer&&(window.HXPUPTimer=[]),void 0===window.HXChimeTimer&&(window.HXChimeTimer=[]);var e={makeTOC:!1,collapsedNav:!1,openPageDiscussion:!1,resizeMaps:!0,markExternalLinks:!1,useBackpack:!0,highlightColor:"#ff0",highlightBackground:"rgba(0,0,0,0)",highlightState:!0,highlightCode:!0,slickOptions:{arrows:!0,dots:!0,focusOnChange:!0,infinite:!0,slidesToShow:3,slidesToScroll:3},slickNavOptions:{asNavFor:".hx-bigslider",variableWidth:!0,focusOnSelect:!0,slidesToShow:3,slidesToScroll:1},slickBigOptions:{asNavFor:".hx-navslider",arrows:!1,dots:!0,fade:!0,focusOnChange:!0,adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1},textSliderOptions:{slidesFile:"TextSliderCards.csv",startingSlide:"",slideScope:[],overviewIsOpen:!1,showBottomNav:!0,maxIconsTall:2,causeEffect:["Causes","Effects"]},PUPOptions:{width:800,effect:"fade",effectlength:200,myPosition:"center",atPosition:"center",ofTarget:window},VidLinkOptions:{hideLinkAfter:5,effect:"slide",hide:{direction:"down"},show:{direction:"down"},speed:500,location:"bl"},HXEditorOptions:[["style",["style"]],["font",["bold","italic","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link"]],["view",["fullscreen","codeview","help"]]],ChimeOptions:{}},t=S(window.location.href,"complete");if(j(t),S(window.location.href,"site").indexOf("studio")>-1)return void console.log("Running HXJS in studio is probably not great. Quitting.");var i=function(e){let t=S(e,"partial"),i={};return t=t.split(":")[2],i.institution=t.split("+")[0],i.id=t.split("+")[1],i.run=t.split("+")[2],i}(window.location.href),o=i.institution+"."+i.id+"_"+i.run;j({"HX.js":"enabled"}),j({"course log id":o}),Logger.listen("problem_check",null,(e,t)=>k(e,t)),Logger.listen("problem_show",null,(e,t)=>k(e,t)),Logger.listen("problem_reset",null,(e,t)=>k(e,t)),$.getMultiScripts=function(e,t){var i=$.map(e,function(e){return $.getScript((t||"")+e)});return i.push($.Deferred(function(e){$(e.resolve)})),$.when.apply($,i)};var n=[],l={};n.push("hxGlobalOptions.js");var s=$("code");s.length&&(j({code_block:"found"}),n.push("prism.js"));var a=$(".hx-slider"),r=$(".hx-navslider"),c=$(".hx-bigslider");(a.length||r.length&&c.length)&&(j({image_slider:"found"}),n.push("slick.js"));var d=$(".hx-dynamic-sliderbox");d.length&&(j({dynamic_slider:"found"}),n.push("papaparse.js"),n.push("hx-text-slider.js"));var h=$("map");h.length&&(j({image_map:"found"}),n.push("imageMapResizer.min.js"));var p,g=$(".hx-editor:visible");g.length>0&&(j({editor:"found"}),n.push("summernote-lite.min.js"),n.push("HXEditor.js"));var u=!0;void 0!==typeof window.hxLocalOptions.dontLoadVideoStuff&&!0===window.hxLocalOptions.dontLoadVideoStuff&&(u=!1,console.log("skipping loading video js"));var f=$(".video");if(u&&f.length>0){var m;if(j({video:"found"}),n.push("HXVideoLinks.js"),window.HXPUPTimer.length>0)n.push("HXPopUpProblems.js");if(window.HXChimeTimer.length>0)n.push("HXVideoChime.js")}function x(o){if(window.hxOptions=o,console.log("Window hxOptions set"),0===$("#hxbackpackframe").length&&o.useBackpack){let e="https://courses.edx.org/xblock/block-v1:"+i.institution+"+"+i.id+"+"+i.run+"+type@problem+block@backpack",t=$("<iframe></iframe>");t.attr("src",e),t.attr("id","hxbackpackframe"),t.attr("aria-hidden","true"),t.attr("tabindex","-1"),t.css("display","none"),$("body").append(t)}if(g.length){$("head").append($('<link rel="stylesheet" href="'+t+'summernote-lite.min.css" type="text/css" />'));let e=$('<div class="hx-loading-indicator"> Editor loading...</div>'),i=$('<span class="fa fa-spinner fa-pulse"></span>');e.prepend(i),g.append(e),hxBackpackLoaded&&void 0===p?p=new HXEditor(o.useBackpack,o.HXEditorOptions):(console.log("Backpack: "+hxBackpackLoaded),console.log("HXED: "+typeof p=="undefined"?"undefined":"ok"))}f.length>0&&u&&($("head").append($('<link rel="stylesheet" href="'+t+'VideoLinks.css" type="text/css" />')),m=new HXVideoLinks(o.VidLinkOptions),$(".jumptime").on("click tap",function(e){e.preventDefault();let t=1;void 0!==$(this).attr("data-for-vidnum")&&(t=$(this).attr("data-for-vidnum")),X(t,L($(this).attr("href")))}),0!==window.HXPUPTimer.length&&new HXPopUpProblems(e.PUPOptions,window.HXPUPTimer),0!==window.HXChimeTimer.length&&new HXVideoChime(e.ChimeOptions,window.HXChimeTimer)),h.length&&o.resizeMaps&&$("map").imageMapResize(),s.length&&o.highlightCode&&$("head").append($('<link rel="stylesheet" href="'+t+'prism.css" type="text/css" />')),$("a.hx-vidtime").on("click tap",function(){let e=L($(this).attr("data-time")),t=$(this).attr("href"),i=t.slice(t.indexOf("#video")).replace("#video",""),o=t.slice(t.indexOf("/jump_to_id/")+13,t.indexOf("#video"));0===t.indexOf("#")?(j({"link starts video at time":e}),m.jumpToTime(i,e)):(localStorage.HXVideoLinkGo="true",localStorage.HXVideoLinkUnit=o,localStorage.HXVideoLinkNumber=i,localStorage.HXVideoLinkTime=e,j({"storing video info for jump":{unit:o,"video number":i,time:e}}))}),o.collapsedNav&&($(".sequence-nav").hide(),$(".sequence > .path").hide(),$("h3.unit-title").hide());let n=$("#hx-tint");n.length&&$(n).on("click tap",function(){$("p").animate({color:"blue"})}),o.openPageDiscussion&&$(".discussion-show.btn").click(),o.markExternalLinks&&(j("marking external links"),$(".vert .xblock a, .static_tab_wrapper .xblock a").each(function(e,t){T($(t).attr("href"))&&$(t).append(' <span class="fa fa-external-link"><span class="sr">External link</span></span>')}));O("hx-togglebutton","hx-toggletarget","hx-toggleremember"),$("[class^=hx-highlighter]").on("click tap",function(){let e=H(this.className,"hx-highlighter");o.highlightState?$(".hx-highlight"+e).css({"background-color":o.highlightColor,transition:"background 0.2s"}):$(".hx-highlight"+e).css({"background-color":o.highlightBackground,transition:"background 0.2s"}),o.highlightState=!o.highlightState,j({"Highlight button":"pressed","Highlight number":e})}),o.makeTOC&&function(){$(".edx-notes-wrapper-content").length?$(".edx-notes-wrapper-content:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>'):$($("#seq_content .vert .xblock")[0]).prepend('<div id="autoTOC" class="hx-autotoc"></div>');let e="<h3>Table of Contents</h3><ul>",t=$("h3, h4").filter(function(){return $(this).is(":visible")});$("#autoTOC ul");t.each(function(i){$(this).attr("id","TOCLink"+i);let o,n=$(this).text();$(this).is("h3")&&(o=3,$(t[i-1]).is("h3")||0===i?e+='<li class="autotoc'+o+'"><a href="#TOCLink'+i+'">'+n+"</a></li>":$(t[i-1]).is("h4")&&(e+='</ul></li><li class="autotoc'+o+'"><a href="#TOCLink'+i+'">'+n+"</a></li>")),$(this).is("h4")&&(o=4,$(t[i-1]).is("h3")?(i>0&&e.slice(0,e.length-5),e+='<ul><li class="autotoc'+o+'"><a href="#TOCLink'+i+'">'+n+"</a></li>"):$(t[i-1]).is("h4")&&(e+='<li class="autotoc'+o+'"><a href="#TOCLink'+i+'">'+n+"</a></li>"))}),e+="</ul>",$("#autoTOC").append(e)}(),$(".hx-popup-opener").length&&($("map").each(function(e){let t=[];$(this).find("area").each(function(e){t.push('<li class="'+this.className.split(/\s+/)[0]+' hx-popup-opener" title="'+this.title+'"><a href="javascript:;">'+this.title+"</a></li>")});let i="<ul>"+t.join("")+"</ul>";i="<h4>Clickable Areas:</h4>"+i;let o=$(this).data("make-accessible-list");"false"===o||!1===o||$(this).after(i)}),$(".hx-popup-opener").on("click tap",function(){let e=this.className,t=e.split(/\s+/)[0];$("div."+t).dialog({dialogClass:"hx-popup-dialog",title:$(this).attr("title"),show:{effect:"fade",duration:200},hide:{effect:"fade",duration:100},buttons:{Close:function(){$(this).dialog("close")}}},function(e){$("div."+e).css({display:""}),alert(e)}),j({"Pop-up Dialog":"opened",Dialog:t})}));let l=$('span[class^="hx-footnote"]');l.length&&function(e){let t,i,o,n,l;for(let s=0;s<e.length;s++)t=e[s],i=H(t.className,"hx-footnote"),o=$("div.hx-footnote-target"+i),$(t).addClass("hx-footnote-style"),$(t).wrap("<sup></sup>"),n=$('h3:contains("Footnote")'),l=$(n[n.length-1]).parent(),$(o).detach().appendTo(l),$(t).wrap('<a href="#hxfoot'+i+'" name="hxfootback'+i+'"></a>').wrap(),o.prepend('<a name="hxfoot'+i+'"></a>'),o.append('<p><a href="#hxfootback'+i+'">(back)</a></p>')}(l),d.length&&($("head").append($('<link rel="stylesheet" href="'+t+'hx-text-slider.css" type="text/css" />')),console.log(o.textSliderOptions),new HXTextSlider(o.textSliderOptions),j({"dynamic slider":"created"})),a.length&&($("head").append($('<link rel="stylesheet" href="'+t+'slick.css" type="text/css" />')),$("head").append($('<link rel="stylesheet" href="'+t+'slick-theme.css" type="text/css" />')),a.slick(o.slickOptions),j({slider:"created"})),r.length&&c.length&&($("head").append($('<link rel="stylesheet" href="'+t+'slick.css" type="text/css" />')),$("head").append($('<link rel="stylesheet" href="'+t+'slick-theme.css" type="text/css" />')),r.slick(o.slickNavOptions),c.slick(o.slickBigOptions),j({"paired slider":"created"}))}$.getMultiScripts(n,t).done(function(){j({"Loaded scripts":n}),x(l=hxGlobalOptions?C(window.hxLocalOptions,hxGlobalOptions,e):C(window.hxLocalOptions,{},e))}).fail(function(t,i,o){console.log(t),console.log(i),console.log(o),j({script_load_error:i}),x(l=C(window.hxLocalOptions,{},e))});function k(e,t){let i;console.log(e,t),"problem_check"===e?i=t.split("_")[1]:"problem_show"===e&&(i=t.problem.split("@")[2]);let o=$('[id^="'+i+'"]').parent()[0];setTimeout(function(){y("hx-togglebutton","hx-toggletarget"),s.length&&l.highlightCode&&Prism.highlightAllUnder(o)},500)}function w(e,t){e="toggle_"+e,console.log("set vis of "+e+" to "+t);try{let i=JSON.parse(localStorage.HXToggleMemory);i[e]=t,localStorage.HXToggleMemory=JSON.stringify(i)}catch(i){console.log("error"),console.log(i),localStorage.HXToggleMemory=JSON.stringify({[e]:t})}}function v(e,t,i,o){console.log("hiding"),$("."+t+o).hide("slide",{direction:"up"},"fast"),$("."+e+o).attr("aria-expanded","false"),$("."+t+o).attr("aria-hidden","true"),$(".hx-toggleset ."+e+o).siblings().attr("disabled",!1),i&&w(o,!1)}function b(e,t,i,o){console.log("showing"),$("."+t+o).show("slide",{direction:"up"},"fast"),$("."+e+o).attr("aria-expanded","true"),$("."+t+o).attr("aria-hidden","false"),$(".hx-toggleset ."+e+o).siblings().attr("disabled",!0),i&&w(o,!0)}function y(e,t){console.log("setting visibility from memory");let i=[];$("[class*="+t+"]").each(function(){let o=H(this.className,t);if(console.log("toggle "+o+"..."),-1===i.indexOf(o)){i.push(o),console.log("...is not handled yet...");let n=function(e){e="toggle_"+e;let t=null;try{console.log(localStorage.HXToggleMemory),t=JSON.parse(localStorage.HXToggleMemory)[e]}catch(e){console.log("error"),console.log(e)}return console.log("visibility for toggle "+e+" is "+t),t}(o);null!=n&&(n?(console.log("...should be shown. Showing it."),b(e,t,!1,o)):(console.log("...should be hidden. Hiding it."),v(e,t,!1,o)))}else console.log("...is already handled.")})}function O(e,t,i){let o=[];$("[class*="+e+"]").each(function(){let i=H(this.className,e);-1===o.indexOf(i)&&(console.log("prepping toggle "+i),o.push(i),$("."+t+i+":visible").length>0?($("."+e+i).attr("aria-expanded","true"),$("."+t+i).attr("aria-hidden","false")):($("."+e+i).attr("aria-expanded","false"),$("."+t+i).attr("aria-hidden","true")))}),y(e,t),$(".hx-clearmemory").on("click tap",function(){let t=H(this.className,e);null!==t?w(t,void 0):localStorage.HXToggleMemory=""}),$("[class*="+e+"]").on("click tap",function(){let o=H(this.className,e),n=$(this).hasClass(i),l="";var s,a,r;"true"===$(this).attr("aria-expanded")?(l="invisible",v(e,t,n,o,$(document))):(l="visible",b(e,t,n,o,$(document)),1===$("."+t+o).length&&(s=$("."+t+o)[0],a=s.getBoundingClientRect(),r=Math.max(document.documentElement.clientHeight,window.innerHeight),(a.bottom<0||a.top-r>=0)&&$("."+t+o)[0].scrollIntoView())),j({"Toggle button":"pressed","Toggled to":l,"Toggle number":o})})}function T(e){return void 0!==e&&(!!isNaN(L(e))&&!(e.includes("edx.org")||e.includes("edxapp")||e.includes("edx-cdn.org")||e.includes("edx-video.net")||e.includes("/courses/")||e.includes("/assets/courseware/")||e.includes("jump_to_id")||e.includes("cloudfront.net")||e.includes("mailto")||e.includes("javascript:void")||e.includes("javascript:;")||"#"==e.slice(0,1)))}function S(e,t){let i=(e=(e=e.replace("%2B","+")).replace("%3A",":")).match(/https:\/\/.+\//)[0];if("site"==t)return i;let o=e.replace("courses/course","asset");o.search("xblock/block-v1")>-1&&(o=(o=o.replace("xblock/block","asset")).replace("+type@","/"));let n=o.indexOf("+"),l=o.indexOf("/",n);return o=o.slice(0,l),o+="+type@asset+block/","partial"==t?o.replace(i,""):o}function H(e,t){let i=e.split(/\s+/);for(let e=0;e<i.length;e++)if(0===i[e].indexOf(t))return i[e].slice(t.length);return null}function C(e,t,i){let o={};return e||t?o=e?t?$.extend(!0,{},i,t,e):$.extend(!0,{},i,e):$.extend(!0,{},i,t):i}function L(e){let t=(e=e.toString()).split(":"),i=0;return 3==t.length?i=3600*parseInt(t[0])+60*parseInt(t[1])+Number(t[2]):2==t.length?i=60*parseInt(t[0])+Number(t[1]):1==t.length&&(i=Number(t[0])),i}function X(e,t){let i=$(".video")[e-1],o=$(i).data("video-player-state");void 0!==o.videoPlayer?(console.log("jumping video "+e+" to time "+t),i.scrollIntoView(),o.videoPlayer.player.seekTo(t)):console.log("video "+e+" not ready")}function j(e){console.log(JSON.stringify(e)),Logger.log(o+".hxjs",e)}!function(e){e.fn.hxKonami=function(t,i){return void 0===i&&(i="38,38,40,40,37,39,37,39,66,65"),this.each(function(){let o=[];e(this).keydown(function(e){for(o.push(e.keyCode);o.length>i.split(",").length;)o.shift();o.toString().indexOf(i)>=0&&(o=[],t(e))})})}}(jQuery),$(window).hxKonami(function(){alert("+30 Lives"),j({"easter egg":"Konami Code"})}),$(window).off("message.hx").on("message.hx",function(e){var t=e.originalEvent.data;if(e.originalEvent.origin===location.origin&&"string"==typeof t&&"backpack_ready"===t){console.log("Backpack ready.");let e=$("#hxbackpackframe")[0].contentWindow;window.hxSetData=e.hxSetData,window.hxClearData=e.hxSetData,window.hxGetData=e.hxGetData,window.hxGetAllData=e.hxGetAllData,window.hxBackpackLoaded=e.hxBackpackLoaded,l.useBackpack&&g.length>0&&void 0===p&&(p=new HXEditor(l.useBackpack,l.HXEditorOptions))}}),window.getAssetURL=S,window.hmsToTime=L,window.timeToHMS=function(e){var t,i,o,n="";return e=Math.floor(e),t=Math.floor(e/3600),(i=Math.floor(e/60%60))<10&&(i="0"+i),(o=Math.floor(e%60))<10&&(o="0"+o),n="0:"+o,i>0&&(n=i+":"+o),t>0&&(n=t+":"+i+":"+o),n},window.logThatThing=j,window.prepAccessibleToggles=O,window.isExternalLink=T,window.popDataMap=function(){console.log("Open full-sized map image.");let e=$("#mapframe"),t=e.contents().find("#LargeMapView");e.toggleClass("hx-svg-view"),e.hasClass("hx-svg-view")?t.text("View Regular"):t.text("View Large")},window.jumpToTime=X,window.hxBackpackLoaded=$("#hxbackpackframe").length>0};$(document).ready(function(){HXGlobalJS()});
